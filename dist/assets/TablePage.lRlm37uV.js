import{_ as P,r as y,x as g,b as A,d as q,c as _,o as b,a as t,e as T,F as w,f as N,t as n,n as L,a2 as D,w as V,g as S}from"./main.BXgsBbqy.js";const E={class:"table-container",dir:"rtl"},M={class:"table w-100 table-bordered table-hover bg-white shadow-sm rounded"},R={class:"py-3"},O={class:"py-3"},U={class:"py-3"},G={class:"py-3"},H={class:"py-3"},J={class:"py-3"},K={class:"py-3"},Q={class:"py-3"},W={class:"py-3"},X={class:"py-3"},Y={class:"py-3"},Z={class:"py-3"},tt={class:"py-3"},et={class:"py-3"},st={class:"py-3"},at={class:"py-3"},ot={key:0},nt={__name:"ReportsTable",setup(h,{expose:i}){const o=y([]),e=y(1),a=y(10);let r=0;const p=async()=>{try{const l=await f(),c=l.length;c!==r&&(o.value=l.filter(s=>Object.keys(s).length>0),r=c)}catch(l){console.error("خطأ في التحقق من التغييرات",l)}},m=()=>{setInterval(p,1e3)},f=()=>new Promise((l,c)=>{const s=indexedDB.open("customsPlateDB",1);s.onerror=d=>{console.error("خطأ في فتح قاعدة البيانات",d),c(d)},s.onsuccess=d=>{const B=d.target.result.transaction(["calculations"],"readonly").objectStore("calculations").getAll();B.onsuccess=x=>{const F=x.target.result.map($=>$.owner_name?$:$.data?$.data:{});l(F)},B.onerror=x=>{console.error("خطأ في قراءة البيانات",x),c(x)}},s.onupgradeneeded=d=>{const u=d.target.result;u.objectStoreNames.contains("calculations")||u.createObjectStore("calculations",{keyPath:"id",autoIncrement:!0})}}),k=g(()=>Math.ceil(o.value.length/a.value)),I=g(()=>{const l=(e.value-1)*a.value,c=l+a.value;return o.value.slice(l,c)}),C=l=>{e.value=l};return A(async()=>{try{const l=await f();o.value=l.filter(c=>Object.keys(c).length>0),r=l.length,m()}catch(l){console.error("خطأ في جلب البيانات من IndexedDB",l),o.value=[]}}),q(()=>{clearInterval(m)}),i({currentPage:e,totalPages:k,pageSize:a,updatePage:C,totalItems:g(()=>o.value.length)}),(l,c)=>(b(),_("section",E,[t("table",M,[c[1]||(c[1]=t("thead",null,[t("tr",{class:"align-middle text-center"},[t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"اسم المالك"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"الرقم القومي"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"العنوان"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"الوظيفه"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"الطراز"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"سنه الصنع"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"رقم اللوحه"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"رقم الشاسيه"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"رقم الموتور"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"السلندرات"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"نوع الوقود"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"اخر شركه تامين"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"من تاريخ"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"الى تاريخ"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"صافي القسط"),t("th",{class:"bg-light text-secondary py-3 border-bottom-0 sticky-header"},"الاجمالي")])],-1)),t("tbody",null,[(b(!0),_(w,null,N(I.value,(s,d)=>(b(),_("tr",{key:d,class:"align-middle hover-row"},[t("td",R,n(s.owner_name),1),t("td",O,n(s.owner_national_id),1),t("td",U,n(s.owner_address),1),t("td",G,n(s.owner_job),1),t("td",H,n(s.model),1),t("td",J,n(s.year),1),t("td",K,n(s.plate),1),t("td",Q,n(s.chassis_id),1),t("td",W,n(s.motor_id),1),t("td",X,n(s.cylinders),1),t("td",Y,n(s.fuel_type_id),1),t("td",Z,n(s.insurance_last_vendor),1),t("td",tt,n(s.from_date),1),t("td",et,n(s.to_date),1),t("td",st,n(s.net_premium),1),t("td",at,n(s.total_sum),1)]))),128)),o.value.length===0?(b(),_("tr",ot,c[0]||(c[0]=[t("td",{colspan:"16",class:"text-center py-5"},[t("div",{class:"empty-state"},[t("i",{class:"bi bi-inbox text-muted",style:{"font-size":"2rem"}}),t("p",{class:"text-muted mt-3 mb-0"},"لا توجد بيانات")])],-1)]))):T("",!0)])])]))}},lt=P(nt,[["__scopeId","data-v-c97b0bf5"]]),ct={name:"PageButton",props:{page:{type:Number,required:!0},isActive:{type:Boolean,default:!1}},emits:["click"]};function rt(h,i,o,e,a,r){return b(),_("button",{class:L(["btn btn-outline-secondary px-3 py-1 mx-1 btn-sm",{active:o.isActive}]),onClick:i[0]||(i[0]=p=>h.$emit("click"))},n(o.page),3)}const z=P(ct,[["render",rt]]),it={class:"container",dir:"rtl"},dt={class:"row align-items-center"},ut={class:"col-md-auto d-flex flex-wrap align-items-center gap-2"},bt=["disabled"],_t=["disabled"],gt={class:"pagination mb-0"},ht={key:0,class:"page-item disabled"},pt=["disabled"],yt=["disabled"],vt={class:"col-md-auto ms-auto"},mt={class:"text-muted"},ft={__name:"TablePagination",props:{totalItems:{type:Number,required:!0},pageSize:{type:Number,required:!0}},emits:["page-changed"],setup(h,{emit:i}){const o=h,e=y(1),a=g(()=>Math.ceil(o.totalItems/o.pageSize)),r=g(()=>(e.value-1)*o.pageSize+1),p=g(()=>Math.min(e.value*o.pageSize,o.totalItems)),m=g(()=>a.value<=7?Array.from({length:a.value},(d,u)=>u+1):e.value<=4?[1,2,3,4,5,6]:e.value>=a.value-3?Array.from({length:6},(d,u)=>a.value-5+u):[e.value-2,e.value-1,e.value,e.value+1,e.value+2]),f=g(()=>a.value>7);function k(d){e.value=d,s("page-changed",d)}function I(){e.value!==1&&(e.value=1,s("page-changed",1))}function C(){e.value!==a.value&&(e.value=a.value,s("page-changed",a.value))}function l(){e.value<a.value&&(e.value++,s("page-changed",e.value))}function c(){e.value>1&&(e.value--,s("page-changed",e.value))}const s=i;return(d,u)=>(b(),_("footer",it,[t("div",dt,[t("div",ut,[t("button",{onClick:I,class:"btn btn-outline-secondary btn-sm","aria-label":"First",disabled:e.value===1}," « ",8,bt),t("button",{onClick:c,class:"btn btn-outline-secondary btn-sm","aria-label":"Previous",disabled:e.value===1}," ‹ ",8,_t),t("div",gt,[(b(!0),_(w,null,N(m.value,v=>(b(),D(z,{key:`page-${v}`,page:v,isActive:e.value===v,onClick:j=>k(v)},null,8,["page","isActive","onClick"]))),128)),f.value?(b(),_("span",ht,u[1]||(u[1]=[t("span",{class:"page-link"},"...",-1)]))):T("",!0),a.value>7?(b(),D(z,{key:1,page:a.value,isActive:e.value===a.value,onClick:u[0]||(u[0]=v=>k(a.value))},null,8,["page","isActive"])):T("",!0)]),t("button",{onClick:l,class:"btn btn-outline-secondary btn-sm","aria-label":"Next",disabled:e.value===a.value}," › ",8,pt),t("button",{onClick:C,class:"btn btn-outline-secondary btn-sm","aria-label":"Last",disabled:e.value===a.value}," » ",8,yt)]),t("div",vt,[t("small",mt," اظهار "+n(r.value)+" الي "+n(p.value)+" من "+n(h.totalItems)+" مدخل ",1)])])]))}},kt=P(ft,[["__scopeId","data-v-10a49d15"]]),xt={class:"table-view-container"},$t={class:"table-wrapper"},Pt={class:"pagination-wrapper"},It={__name:"TableView",setup(h){const i=y(null),o=y(0),e=y(10),a=r=>{i.value&&i.value.updatePage(r)};return V(()=>{var r;return(r=i.value)==null?void 0:r.totalItems},r=>{r!==void 0&&(o.value=r)},{immediate:!0}),A(()=>{i.value&&(o.value=i.value.totalItems)}),(r,p)=>(b(),_("div",xt,[p[0]||(p[0]=t("div",{class:"table-header"},[t("h2",{class:"table-title text-end w-100"},"جدول تأمين السيارات")],-1)),t("div",$t,[S(lt,{ref_key:"reportsTable",ref:i},null,512)]),t("div",Pt,[S(kt,{"total-items":o.value,"page-size":e.value,onPageChanged:a},null,8,["total-items","page-size"])])]))}},Ct=P(It,[["__scopeId","data-v-3774cbfc"]]),Tt={class:"bg-black"},St={class:"bg-black"},zt={__name:"TablePage",setup(h){return(i,o)=>(b(),_("section",Tt,[t("div",St,[S(Ct,{class:""})])]))}};export{zt as default};
